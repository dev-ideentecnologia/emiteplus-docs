openapi: 3.0.3
info:
  title: API de Emiss√£o de NFSe Nacional
  description: 'API exclusiva para emiss√£o e cancelamento de Notas Fiscais de Servi√ßo
    Eletr√¥nicas (NFSe), via Portal Nacional. A autentica√ß√£o √© feita via `x-api-key`
    no header.

    '
  version: 1.0.2
servers:
- url: https://api.emiteplus.com.br/v1
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
  schemas:
    Emitente:
      type: object
      required:
      - cpfCnpj
      - razaoSocial
      - email
      - inscricaoMunicipal
      - telefone
      - endereco
      - config
      - certificado
      properties:
        cpfCnpj:
          type: string
        razaoSocial:
          type: string
        nomeFantasia:
          type: string
        email:
          type: string
        inscricaoEstadual:
          type: string
        inscricaoMunicipal:
          type: string
        simplesNacional:
          type: boolean
        incentivadorCultural:
          type: boolean
        incentivoFiscal:
          type: boolean
        regimeTributario:
          type: integer
        regimeTributarioEspecial:
          type: integer
        certificado:
          type: string
          description: ID do certificado digital j√° cadastrado
        telefone:
          type: object
          required:
          - ddd
          - numero
          properties:
            ddd:
              type: string
            numero:
              type: string
        endereco:
          type: object
          required:
          - logradouro
          - numero
          - bairro
          - codigoCidade
          - estado
          - cep
          properties:
            tipoLogradouro:
              type: string
            logradouro:
              type: string
            numero:
              type: string
            complemento:
              type: string
            bairro:
              type: string
            codigoCidade:
              type: string
            estado:
              type: string
            cep:
              type: string
        config:
          type: object
          required:
          - producao
          - prefeitura
          properties:
            producao:
              type: boolean
            prefeitura:
              type: object
              required:
              - codigoCidade
              properties:
                codigoCidade:
                  type: string
                  example: '5208707'
                login:
                  type: string
                senha:
                  type: string
            rps:
              type: object
              properties:
                lote:
                  type: integer
                numeracao:
                  type: array
                  items:
                    type: object
                    properties:
                      numero:
                        type: integer
                      serie:
                        type: string
    EmissaoNFSe:
      type: object
      required:
      - idIntegracao
      - natureza
      - valorTotal
      - servico
      - tomador
      properties:
        idIntegracao:
          type: string
        natureza:
          type: string
          enum:
          - VENDA
          - PRESTACAO
        valorTotal:
          type: number
        servico:
          type: object
          properties:
            codigoTributacao:
              type: string
            descricao:
              type: string
            aliquota:
              type: number
        tomador:
          type: object
          properties:
            cpfCnpj:
              type: string
            razaoSocial:
              type: string
            email:
              type: string
            endereco:
              type: object
              properties:
                tipoLogradouro:
                  type: string
                logradouro:
                  type: string
                numero:
                  type: string
                bairro:
                  type: string
                codigoCidade:
                  type: string
                estado:
                  type: string
                cep:
                  type: string
    CancelamentoNFSe:
      type: object
      required:
      - idIntegracao
      - justificativa
      properties:
        idIntegracao:
          type: string
        justificativa:
          type: string
security:
- ApiKeyAuth: []
paths:
  /certificado:
    post:
      summary: Cadastrar Certificado Digital
      operationId: cadastrarCertificado
      tags:
      - Certificado
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
              - arquivo
              - senha
              properties:
                arquivo:
                  type: string
                  format: binary
                  description: Certificado digital no formato .pfx ou .p12
                senha:
                  type: string
                  description: Senha do certificado digital
                email:
                  type: string
                  format: email
                  description: E-mail para notifica√ß√µes (opcional)
      responses:
        '200':
          description: Certificado cadastrado com sucesso
        '400':
          description: Erro na requisi√ß√£o
        '401':
          description: Token de autentica√ß√£o inv√°lido ou ausente
      security:
      - ApiKeyAuth: []
  /certificado/{id}:
    get:
      summary: Consultar Certificado Digital
      operationId: consultarCertificado
      tags:
      - Certificado
      parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
          example: 64f5f10b3943ac2f88ba29e1
      responses:
        '200':
          description: Certificado encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  cpfCnpj:
                    type: string
                  validade:
                    type: string
                    format: date
                  email:
                    type: string
        '404':
          description: Certificado n√£o encontrado
      security:
      - ApiKeyAuth: []
    delete:
      summary: Excluir Certificado Digital
      operationId: excluirCertificado
      tags:
      - Certificado
      parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
          example: 64f5f10b3943ac2f88ba29e1
      responses:
        '204':
          description: Certificado exclu√≠do com sucesso
        '404':
          description: Certificado n√£o encontrado
      security:
      - ApiKeyAuth: []
  /nfse/emitente:
    post:
      summary: Cadastrar Emitente
      description: 'Cadastra e vincula uma nova Empresa (emitente/prestador) √† sua
        organiza√ß√£o.


        ‚ö†Ô∏è Para evitar erros no processo de emiss√£o, algumas valida√ß√µes s√£o din√¢micas
        e podem ser obrigat√≥rias dependendo do munic√≠pio e do cen√°rio:

        - Inscri√ß√£o Municipal

        - Certificado Digital

        - Credenciais de acesso √† Prefeitura (login e senha)


        üí° **Cen√°rios de uso:**

        - Cadastrar um emitente para **emitir NFS-e**.

        - Cadastrar um emitente para **consultar notas fiscais emitidas contra seu
        CNPJ** (consulta passiva).


        ‚ÑπÔ∏è **Observa√ß√µes importantes:**

        - Para consultar os dados obrigat√≥rios por munic√≠pio, utilize a rota: `/nfse/cidade/{codigoIBGE}`


        ‚úÖ Tamb√©m dispon√≠vel para gerenciamento via interface web.

        '
      operationId: cadastrarEmitente
      tags:
      - Emitente
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Emitente'
      responses:
        '201':
          description: Emitente cadastrado com sucesso
        '400':
          description: Erro de valida√ß√£o
  /nfse/emitente/{cpfCnpj}:
    get:
      summary: Consultar Emitente
      operationId: consultarEmitente
      tags:
      - Emitente
      parameters:
      - in: path
        name: cpfCnpj
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Dados do emitente
        '404':
          description: Emitente n√£o encontrado
  /nfse/emissao:
    post:
      summary: Emitir NFSe
      operationId: emitirNFSe
      tags:
      - NFSe
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmissaoNFSe'
      responses:
        '202':
          description: NFSe enviada para processamento
        '400':
          description: Erro na requisi√ß√£o
  /nfse/cancelamento:
    post:
      summary: Cancelar NFSe
      operationId: cancelarNFSe
      tags:
      - NFSe
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CancelamentoNFSe'
      responses:
        '200':
          description: Cancelamento solicitado
        '404':
          description: NFSe n√£o encontrada
  /nfse/consulta/{idIntegracao}:
    get:
      summary: Consultar Situa√ß√£o da NFSe
      operationId: consultarSituacaoNFSe
      tags:
      - NFSe
      parameters:
      - in: path
        name: idIntegracao
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Status atual da NFSe
        '404':
          description: NFSe n√£o encontrada
  /nfse/cidade/{codigoIBGE}:
    get:
      summary: Consultar Metadados do Munic√≠pio
      description: 'Retorna os metadados de configura√ß√£o exigidos pelo munic√≠pio para
        emiss√£o de NFS-e.


        - Verifica se a cidade est√° integrada ao Portal Nacional ou WebService pr√≥prio

        - Indica se exige certificado digital, login/senha, inscri√ß√£o municipal, etc.


        üîç Exemplo de uso:

        `/nfse/cidade/5208707`

        '
      operationId: consultarCidade
      tags:
      - Auxiliares
      parameters:
      - in: path
        name: codigoIBGE
        required: true
        schema:
          type: string
        description: C√≥digo IBGE da cidade (7 d√≠gitos)
      responses:
        '200':
          description: Metadados do munic√≠pio
          content:
            application/json:
              schema:
                type: object
                properties:
                  nome:
                    type: string
                  codigoIBGE:
                    type: string
                  exigeCertificado:
                    type: boolean
                  exigeCredencial:
                    type: boolean
                  usaPortalNacional:
                    type: boolean
                  inscricaoMunicipalObrigatoria:
                    type: boolean
        '404':
          description: Munic√≠pio n√£o encontrado
      security:
      - ApiKeyAuth: []
tags:
- name: Certificado
  description: Gest√£o de certificados digitais
- name: Emitente
  description: Cadastro e configura√ß√£o de empresas emissoras
- name: Auxiliares
  description: Rotas de apoio e metadados dos munic√≠pios
- name: NFSe
  description: Opera√ß√µes de emiss√£o, cancelamento e consulta de NFSe
